/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { Pipe } from '@angular/core';
// unsupported: template constraints.
/**
 * @template R
 */
export class GtSearchPipe {
    constructor() {
        /**
         * Return property
         */
        this.getProperty = function (array, key) {
            for (let /** @type {?} */ i = 0; i < array.length; i++) {
                if (array[i].objectKey === key) {
                    return array[i];
                }
            }
        };
    }
    /**
     * @param {?} allRows
     * @param {?} searchTerms
     * @param {?} gtInfo
     * @param {?} settings
     * @param {?} fields
     * @param {?} refreshData
     * @return {?}
     */
    transform(allRows, searchTerms, gtInfo, settings, fields, refreshData) {
        //  if no search terms are defined...
        if (!searchTerms || searchTerms.replace(/"/g, '').length === 0) {
            // ...return all rows
            const /** @type {?} */ length = allRows === null ? 0 : allRows.length;
            gtInfo.recordsAfterSearch = length;
            return allRows;
        }
        const /** @type {?} */ searchFunction = {};
        const /** @type {?} */ fieldsTemp = [];
        for (let /** @type {?} */ k = 0; k < fields.length; k++) {
            const /** @type {?} */ field = fields[k];
            // check if field should be included in global search
            const /** @type {?} */ include = this.getProperty(settings, field.objectKey).search === false
                ? false
                : true;
            // if include...
            if (include) {
                // ...and if search function is defined...
                if (typeof field.search === 'function') {
                    // ...add it as search function for field
                    searchFunction[field.objectKey] = field.search;
                }
                // ...if no search function is defined but value function is defined...
                else if (typeof field.value === 'function') {
                    // ...add it as search function for field
                    searchFunction[field.objectKey] = field.value;
                }
                // ...push it to our fields array
                fieldsTemp.push(field);
            }
        }
        const /** @type {?} */ filteredRows = [];
        searchTerms = typeof searchTerms === 'undefined' ? '' : searchTerms;
        const /** @type {?} */ searchTermsArray = searchTerms.toLowerCase().match(/(".*"|[^\s]+)/g);
        for (let /** @type {?} */ i = 0; i < allRows.length; i++) {
            const /** @type {?} */ row = allRows[i];
            let /** @type {?} */ string = '';
            for (let /** @type {?} */ j = 0; j < fieldsTemp.length; j++) {
                const /** @type {?} */ separator = j === 0 ? '' : ' & ';
                string += searchFunction[fieldsTemp[j].objectKey]
                    ? separator + searchFunction[fieldsTemp[j].objectKey](row, j)
                    : separator + row[fieldsTemp[j].objectKey];
            }
            string = string.toLowerCase();
            let /** @type {?} */ match = true;
            for (let /** @type {?} */ k = 0; k < searchTermsArray.length; k++) {
                const /** @type {?} */ term = searchTermsArray[k].replace(/"/g, '');
                match = string.indexOf(term) !== -1;
                if (!match) {
                    break;
                }
            }
            if (match) {
                filteredRows.push(row);
            }
        }
        gtInfo.recordsAfterSearch = filteredRows.length;
        // gtInfo.refresh(filteredRows.length,gt);
        return filteredRows;
    }
}
GtSearchPipe.decorators = [
    { type: Pipe, args: [{
                name: 'gtSearch'
            },] },
];
function GtSearchPipe_tsickle_Closure_declarations() {
    /** @type {!Array<{type: !Function, args: (undefined|!Array<?>)}>} */
    GtSearchPipe.decorators;
    /**
     * @nocollapse
     * @type {function(): !Array<(null|{type: ?, decorators: (undefined|!Array<{type: !Function, args: (undefined|!Array<?>)}>)})>}
     */
    GtSearchPipe.ctorParameters;
    /**
     * Return property
     * @type {?}
     */
    GtSearchPipe.prototype.getProperty;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3Qtc2VhcmNoLnBpcGUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYW5ndWxhci1nZW5lcmljLXRhYmxlL2NvcmUvIiwic291cmNlcyI6WyJwaXBlcy9ndC1zZWFyY2gucGlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLElBQUksRUFBaUIsTUFBTSxlQUFlLENBQUM7Ozs7O0FBU3BELE1BQU07Ozs7OzJCQUVpQixVQUFTLEtBQWlCLEVBQUUsR0FBVztZQUM1RCxLQUFLLHFCQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ3RDLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsS0FBSyxHQUFHLEVBQUU7b0JBQy9CLE9BQU8sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO2lCQUNoQjthQUNEO1NBQ0Q7Ozs7Ozs7Ozs7O0lBRUQsU0FBUyxDQUNSLE9BQVksRUFDWixXQUFtQixFQUNuQixNQUFxQixFQUNyQixRQUFnQyxFQUNoQyxNQUFvQyxFQUNwQyxXQUFtQjs7UUFHbkIsSUFBSSxDQUFDLFdBQVcsSUFBSSxXQUFXLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFOztZQUUvRCx1QkFBTSxNQUFNLEdBQUcsT0FBTyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDO1lBQ3JELE1BQU0sQ0FBQyxrQkFBa0IsR0FBRyxNQUFNLENBQUM7WUFDbkMsT0FBTyxPQUFPLENBQUM7U0FDZjtRQUVELHVCQUFNLGNBQWMsR0FBUSxFQUFFLENBQUM7UUFDL0IsdUJBQU0sVUFBVSxHQUFlLEVBQUUsQ0FBQztRQUVsQyxLQUFLLHFCQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxNQUFNLEVB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U0FBQztnQkFDTCxJQUFJLEVBQUUsVUFBVTthQUNoQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBpcGUsIFBpcGVUcmFuc2Zvcm0gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgR3RDb25maWdGaWVsZCB9IGZyb20gJy4uL2ludGVyZmFjZXMvZ3QtY29uZmlnLWZpZWxkJztcclxuaW1wb3J0IHsgR3RSb3cgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2d0LXJvdyc7XHJcbmltcG9ydCB7IEd0Q29uZmlnU2V0dGluZyB9IGZyb20gJy4uL2ludGVyZmFjZXMvZ3QtY29uZmlnLXNldHRpbmcnO1xyXG5pbXBvcnQgeyBHdEluZm9ybWF0aW9uIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9ndC1pbmZvcm1hdGlvbic7XHJcblxyXG5AUGlwZSh7XHJcblx0bmFtZTogJ2d0U2VhcmNoJ1xyXG59KVxyXG5leHBvcnQgY2xhc3MgR3RTZWFyY2hQaXBlPFIgZXh0ZW5kcyBHdFJvdz4gaW1wbGVtZW50cyBQaXBlVHJhbnNmb3JtIHtcclxuXHQvKiogUmV0dXJuIHByb3BlcnR5ICovXHJcblx0cHJpdmF0ZSBnZXRQcm9wZXJ0eSA9IGZ1bmN0aW9uKGFycmF5OiBBcnJheTxhbnk+LCBrZXk6IHN0cmluZykge1xyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRpZiAoYXJyYXlbaV0ub2JqZWN0S2V5ID09PSBrZXkpIHtcclxuXHRcdFx0XHRyZXR1cm4gYXJyYXlbaV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHR0cmFuc2Zvcm0oXHJcblx0XHRhbGxSb3dzOiBhbnksXHJcblx0XHRzZWFyY2hUZXJtczogc3RyaW5nLFxyXG5cdFx0Z3RJbmZvOiBHdEluZm9ybWF0aW9uLFxyXG5cdFx0c2V0dGluZ3M6IEFycmF5PEd0Q29uZmlnU2V0dGluZz4sXHJcblx0XHRmaWVsZHM6IEFycmF5PEd0Q29uZmlnRmllbGQ8UiwgYW55Pj4sXHJcblx0XHRyZWZyZXNoRGF0YTogbnVtYmVyXHJcblx0KTogYW55IHtcclxuXHRcdC8vICBpZiBubyBzZWFyY2ggdGVybXMgYXJlIGRlZmluZWQuLi5cclxuXHRcdGlmICghc2VhcmNoVGVybXMgfHwgc2VhcmNoVGVybXMucmVwbGFjZSgvXCIvZywgJycpLmxlbmd0aCA9PT0gMCkge1xyXG5cdFx0XHQvLyAuLi5yZXR1cm4gYWxsIHJvd3NcclxuXHRcdFx0Y29uc3QgbGVuZ3RoID0gYWxsUm93cyA9PT0gbnVsbCA/IDAgOiBhbGxSb3dzLmxlbmd0aDtcclxuXHRcdFx0Z3RJbmZvLnJlY29yZHNBZnRlclNlYXJjaCA9IGxlbmd0aDtcclxuXHRcdFx0cmV0dXJuIGFsbFJvd3M7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3Qgc2VhcmNoRnVuY3Rpb246IGFueSA9IHt9O1xyXG5cdFx0Y29uc3QgZmllbGRzVGVtcDogQXJyYXk8YW55PiA9IFtdO1xyXG5cclxuXHRcdGZvciAobGV0IGsgPSAwOyBrIDwgZmllbGRzLmxlbmd0aDsgaysrKSB7XHJcblx0XHRcdGNvbnN0IGZpZWxkID0gZmllbGRzW2tdO1xyXG5cclxuXHRcdFx0Ly8gY2hlY2sgaWYgZmllbGQgc2hvdWxkIGJlIGluY2x1ZGVkIGluIGdsb2JhbCBzZWFyY2hcclxuXHRcdFx0Y29uc3QgaW5jbHVkZSA9XHJcblx0XHRcdFx0dGhpcy5nZXRQcm9wZXJ0eShzZXR0aW5ncywgZmllbGQub2JqZWN0S2V5KS5zZWFyY2ggPT09IGZhbHNlXHJcblx0XHRcdFx0XHQ/IGZhbHNlXHJcblx0XHRcdFx0XHQ6IHRydWU7XHJcblxyXG5cdFx0XHQvLyBpZiBpbmNsdWRlLi4uXHJcblx0XHRcdGlmIChpbmNsdWRlKSB7XHJcblx0XHRcdFx0Ly8gLi4uYW5kIGlmIHNlYXJjaCBmdW5jdGlvbiBpcyBkZWZpbmVkLi4uXHJcblx0XHRcdFx0aWYgKHR5cGVvZiBmaWVsZC5zZWFyY2ggPT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0XHRcdC8vIC4uLmFkZCBpdCBhcyBzZWFyY2ggZnVuY3Rpb24gZm9yIGZpZWxkXHJcblx0XHRcdFx0XHRzZWFyY2hGdW5jdGlvbltmaWVsZC5vYmplY3RLZXldID0gZmllbGQuc2VhcmNoO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyAuLi5pZiBubyBzZWFyY2ggZnVuY3Rpb24gaXMgZGVmaW5lZCBidXQgdmFsdWUgZnVuY3Rpb24gaXMgZGVmaW5lZC4uLlxyXG5cdFx0XHRcdGVsc2UgaWYgKHR5cGVvZiBmaWVsZC52YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0XHRcdFx0Ly8gLi4uYWRkIGl0IGFzIHNlYXJjaCBmdW5jdGlvbiBmb3IgZmllbGRcclxuXHRcdFx0XHRcdHNlYXJjaEZ1bmN0aW9uW2ZpZWxkLm9iamVjdEtleV0gPSBmaWVsZC52YWx1ZTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vIC4uLnB1c2ggaXQgdG8gb3VyIGZpZWxkcyBhcnJheVxyXG5cdFx0XHRcdGZpZWxkc1RlbXAucHVzaChmaWVsZCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBmaWx0ZXJlZFJvd3M6IEFycmF5PGFueT4gPSBbXTtcclxuXHRcdHNlYXJjaFRlcm1zID0gdHlwZW9mIHNlYXJjaFRlcm1zID09PSAndW5kZWZpbmVkJyA/ICcnIDogc2VhcmNoVGVybXM7XHJcblx0XHRjb25zdCBzZWFyY2hUZXJtc0FycmF5ID0gc2VhcmNoVGVybXMudG9Mb3dlckNhc2UoKS5tYXRjaCgvKFwiLipcInxbXlxcc10rKS9nKTtcclxuXHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGFsbFJvd3MubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0Y29uc3Qgcm93ID0gYWxsUm93c1tpXTtcclxuXHRcdFx0bGV0IHN0cmluZyA9ICcnO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgaiA9IDA7IGogPCBmaWVsZHNUZW1wLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0Y29uc3Qgc2VwYXJhdG9yID0gaiA9PT0gMCA/ICcnIDogJyAmICc7XHJcblx0XHRcdFx0c3RyaW5nICs9IHNlYXJjaEZ1bmN0aW9uW2ZpZWxkc1RlbXBbal0ub2JqZWN0S2V5XVxyXG5cdFx0XHRcdFx0PyBzZXBhcmF0b3IgKyBzZWFyY2hGdW5jdGlvbltmaWVsZHNUZW1wW2pdLm9iamVjdEtleV0ocm93LCBqKVxyXG5cdFx0XHRcdFx0OiBzZXBhcmF0b3IgKyByb3dbZmllbGRzVGVtcFtqXS5vYmplY3RLZXldO1xyXG5cdFx0XHR9XHJcblx0XHRcdHN0cmluZyA9IHN0cmluZy50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0XHRsZXQgbWF0Y2g6IEJvb2xlYW4gPSB0cnVlO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgayA9IDA7IGsgPCBzZWFyY2hUZXJtc0FycmF5Lmxlbmd0aDsgaysrKSB7XHJcblx0XHRcdFx0Y29uc3QgdGVybSA9IHNlYXJjaFRlcm1zQXJyYXlba10ucmVwbGFjZSgvXCIvZywgJycpO1xyXG5cdFx0XHRcdG1hdGNoID0gc3RyaW5nLmluZGV4T2YodGVybSkgIT09IC0xO1xyXG5cclxuXHRcdFx0XHRpZiAoIW1hdGNoKSB7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKG1hdGNoKSB7XHJcblx0XHRcdFx0ZmlsdGVyZWRSb3dzLnB1c2gocm93KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Z3RJbmZvLnJlY29yZHNBZnRlclNlYXJjaCA9IGZpbHRlcmVkUm93cy5sZW5ndGg7XHJcblx0XHQvLyBndEluZm8ucmVmcmVzaChmaWx0ZXJlZFJvd3MubGVuZ3RoLGd0KTtcclxuXHRcdHJldHVybiBmaWx0ZXJlZFJvd3M7XHJcblx0fVxyXG59XHJcbiJdfQ==